(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,n){e.exports=n.p+"static/media/lym-rush-logo-white.2c0e3b7c.png"},17:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFCUlEQVR4nO3cvYtcZQDF4bOboAZjI7qktBNtkghGsNQNKbRNE/8Bv/vUYmcj5qOPFlqkEwKKkFYIiLGx8iMouoKgTSDRoMWNYkJismTfOzt7ngeGdPdOit/ZmTtzJwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAArsW/QTYUfYkeTjJSpKrC34uwAzWk5xJcinJX/95bCQ5m+RoktWFPTtgiANJzufG6G/3+DLJcwt5lsCWeynJ5dxd/P88riU5vognC2ydY9lc+Dc/TmW6RgAsmQPZ/F/+Wz1OxgjA0jmfe4/fCMASWs/WxW8EYMmcydYPgBGAJXHz5/xGAErsybj4jQBsc2sZPwBGALapvZlnAIwAbFMbMQJQ62zmGwAjANvM0cw7AEYAtpHVJF/FCECtw5nu6jMCO4RfBGIzvsk0AHPf2/90kkeTnJv5vMAtnMr8rwK8EoBtYiVGAKoZASi36BEAFswIQDkjAOWMAJQzAlDOCEA5IwDljACUMwJQzghAOSMA5VYyxWgEoJQRgHJGAMoZAShnBKCcEYByRgDKGQEoZwSg3CJH4MQM/z/gDowAlDMCUM4IQDkjABgBaGcEoJwRgHJGAMoZAShnBKCcEYByRgDKGQEoZwSgnBGAckYAyhkBKGcEoNyiRuC9Of5zwJ2diBGAakYAyhkBKGcEoJwRgHJGAMoZAShnBKCcEYByRgDKGQEoZwSgnBGAcjUjsHvuEyZZS3IkycEk+5Lct4DnAHdyJcn9M5/z9ev/vjHzeWfxWJL3k/yRxayrh8eyPGZ7JbBrpvO8nOTjJE8lWZ3pnLCsDiV5JMm50SeaYwDeSfJ2FvN2A5bVoSQPJflk5ElGD8ArmeIHNu/ZJD8k+WLUCVZGHTjTe/6vM/+FFNhJriR5Ism3Iw4+8v34WxE/3Kv7M7U0xKhXAGtJfoz3/bAV/sx0UfD3rT7wqFcARyJ+2Cq7MzW15UYNwMFBx4VWz4w46KgB2DfouNBqSFO+lAPLYcj1ulED8POg40Krn0YcdNQADPviApT6fMRBfQwI29/SfQz4S5IPBx0b2nyUAfEnvgoM293VJI8n+W7EwUfeDPRbkl+TvDDwHLDTvZrks1EHH3034IUkezPd1QRszrsZfDftHL8H8GmSjSSH46Ig3K3TSd4cfZK5fhHoQpIPMl3JfDK+gAT/53SS1zL9PNhQIy8C3o4fBWUZvJjFXMCeLX7g1hb1s+Cnspg/ysB14odS4odS4odS4odS4odS4odS4odS4odS4odS4odS4odS4odS4odSJyN+qCR+KCV+KCV+KCV+KCV+KCV+KCV+KCV+KCV+KCV+KCV+KCV+KCV+KLQS8UMl8UMp8UMp8UMp8UMp8UMp8UMp8UMp8UMp8UMp8UMp8UMp8UMp8UOplUwRih/KiB9KiR9KiR9KiR9KiR9KiR9KiR9KiR9KiR9KiR9KiR9KiR9KiR+KiR9KHY/4odLzSa5F/FBnNcnFiB8qHY34odbZiB9qbUT8UGlvxA+11iJ+qLUn4odqlyJ+qHUm4oda6xE/VDsf8UOt/UkuR/xQ61jED9WOZfOvBK5lupUY2AH25+6vCVzMdBER2GHWM31E+H1ujH4j0w1ERzPdSgzscA9k+trwg4t+IgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//obqF9iK/30TNcAAAAASUVORK5CYII="},18:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFXUlEQVR4nO3cPYucVRgG4Hs38SMY1CZBsUlnGWxELZOojZUYQf+AioKtH6WCjY24u70RgoLpRFCR2ApCiDbaGask2tgEo4ljMVmIyjqzmznn7M5zXXDac96nuO/5fN8EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArYN/oCmNvBJPcm+SvJtcHXAjS2muTZJGeSXEoyuWn9nORUkhPDrg5o5vEk3+efod9qfZ3k6JCrBBbuzSTXM1/4N9eVJM+PuFhgMVaSbGR7wf/3UgKwBy0i/JvvBHwcgD1kUeHfXGf7Xj6wU4sO/+Y63nMIYPtahX+S6U+EwC7VMvyTTP8nAOxCrcO/uQ70GgiYT6/wT5Ic7jQTMIee4Z9keu8AsAv0Dv+lPmMBs/QO/yTTG4iAwUaEf5LkZI/hgK2NCv/5TG8lBgYZFf7rSY51mA/YwqjwT5K81mE+YAsjw7/RYT5gCyPDv37jfGAA4YeihB+KEn4oSvihKOGHooQfihJ+KEr4oSjhh6KEH4oSfihK+KGo0eEHBhF+KEr4oSjhh6KEH4oSfihK+KEo4YeihB+KEn4oSvihKOGHooQfihJ+KGpk+Nc6zAdsQfihKOGHooQfihJ+KEr4oSjhh6KEH4oSfihK+KEo4YeihB+KEn4oSvihKOGHokaG//0O8wFbEH4oSvihKOGHooQfihJ+KEr4oSjhh6KEH4oSfihK+KEo4YeihB+KEn7YRVY6n7We5KWOZ266muTTAefCLH8kuZjkXJLPk1weezltjHzlt6y9sv5M8mGSI1kiwm9Z21u/J3kxHezrcMZ7SV7pcA4si/1JnkpyMMmXLQ9qXQAvJHmr8RmwrB5LcinJt60OaPkl4JEkPya5veEZsOyuJnkwyYUWm6+22PSGtyP8cKvuyDRLTbR6B3BPkl8z/SwD3JprSR5Ig58IW70DeCLCD4uyP8mTLTZuVQCPNNoXqnqoxaatCuD+RvtCVfe12LRVAUwa7QssUKsCuNhoX6iqSaZaFcA3jfaFqs612LTlz4C/JLmt0f5QyZ77GfC3JB832huq+SiNbhNu/VfgHzL9JxOwM3v2r8A/JXm54f5QwatpFP6k/d2A55LcneTRxufAMno3yTstD+jxPIAvkhxK8nCHs2AZXM30GRpNw5/0KYAk+SxKAGa5luR0kqeTfNXjwJ4PBU2StYz5XsBDQdmtSjwU9GZrGfOcNY8Fh11CCUBxSgCKUwJQnBKA4pQAFKcEoDglAMUpAShOCUBxSgCKUwJQnBKA4pQAFDeqBNZ6DAfMpgSguPUoAShNCUBxSgCKUwJQnBKA4pQAFKcEoDglAMUpAShOCUBxSgCKUwJQnBKA4kaVwHqP4YDZlAAUpwSgOCUAxSkBKE4JQGErUQJQmhKA4pQAFKcEoDglAMUpAShOCUBxo0tgpf2IwP9RAlCcEoDilAAUpwSgOCUAxSkBKE4JQHFKAIpTAlCcEoDiVpJsRAlAWUoAilMCUNzIEtjoMB8ww8gSeKPDfMAMo0rgepITHeYDZhhVAt8lWe0wHzDDqBI42WM4YLYRJXCmy2TAXHqXwOU+YwHz6l0CB/uMBcyrZwkc7jQTsA29SuBAr4GA7WldAhf6jQLsRMsSONVxDmCHWpXA8Z5DADu36BI42/fygVu1qBK4kuRo52sHFmARJfBc96sGFur1TO/q2+4rv/DDkjiW5Hzm/8zvbT8smdUkzyT5JMnF/Pd3/g/i234o464kh5LcOfpCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD2lL8BW5VQcuGWN1YAAAAASUVORK5CYII="},21:function(e,t,n){e.exports=n(48)},28:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(15),A=n.n(r),i=(n(26),n(28),n(19)),s=n(2),l=n(3),c=n(5),u=n(4),m=n(6),d=n(8),g=n.n(d),h=n(16),f=n.n(h),w=n(17),p=n.n(w),E=n(18),S=n.n(E);var C=function(e){var t=o.a.createElement("div",{className:"logout-container",onClick:e.handle_logout},"Logout");return o.a.createElement("div",null,e.logged_in?t:null)},k=n(20),v=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={username:"",password:""},n.handle_change=function(e){var t=e.target.name,a=e.target.value;n.setState(function(e){var n=Object(k.a)({},e);return n[t]=a,n})},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("form",{className:"login-form",onSubmit:function(t){return e.props.handle_login(t,e.state)}},o.a.createElement("label",{className:"login-label",htmlFor:"username"},"Username",o.a.createElement("input",{type:"text",name:"username",value:this.state.username,className:"login-input",onChange:this.handle_change})),o.a.createElement("label",{className:"login-label",htmlFor:"password"},"Password",o.a.createElement("input",{type:"password",name:"password",value:this.state.password,className:"login-input",onChange:this.handle_change})),o.a.createElement("br",null),o.a.createElement("input",{className:"login-submit",type:"submit"}))}}]),t}(o.a.Component),K=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).refreshList=function(){g.a.get("".concat(n.baseUrl,"/api/readings/"),{headers:{"Content-type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("token"))}}).then(function(e){var t=e.data;n.setState({readingList:t}),n.setState({currentItem:n.getTodaysReading()})}).catch(function(e){console.log(e),n.setState({loginError:!0,logged_in:!1,username:null,displayed_form:"login",currentItem:null}),localStorage.removeItem("token")})},n.getNewsItem=function(){g.a.get("".concat(n.baseUrl,"/api/news_items/"),{headers:{"Content-type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("token"))}}).then(function(e){var t=e.data;n.setState({news_items:t})}).catch(function(e){console.log(e),n.setState({loginError:!0,logged_in:!1,username:null,displayed_form:"login",currentItem:null}),localStorage.removeItem("token")})},n.handle_login=function(e,t){var a=n.getCookie("csrftoken");n.setState({loginError:!1}),e.preventDefault(),fetch("".concat(n.baseUrl,"/token-auth/"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRFTOKEN":a},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){localStorage.setItem("token",e.token),n.setState({logged_in:!0,displayed_form:"",username:e.user.username}),n.refreshList(),n.getNewsItem()}).catch(function(e){n.setState({loginError:!0,logged_in:!1,username:null,displayed_form:"login",currentItem:null}),localStorage.removeItem("token")})},n.handle_logout=function(){localStorage.removeItem("token"),n.setState({logged_in:!1,username:""})},n.display_form=function(e){n.setState({displayed_form:e})},n.getTodaysReading=function(){var e=n.state.readingList,t=n.getClosestReadingToToday(Object(i.a)(e));return n.setState({currentItem:t}),t},n.getTodaysNewsItem=function(){var e=n.state.news_items;return e?n.getClosestNewsItemToToday(e):null},n.displayCompleted=function(e){return e?n.setState({viewCompleted:!0}):n.setState({viewCompleted:!1})},n.renderItems=function(){var e=n.state.currentItem;return e?o.a.createElement("div",{className:"items",key:e.id},o.a.createElement("li",{key:e.id,className:"d-flex justify-content-between align-items-center"},o.a.createElement("span",{className:"reading-title mr-2"},e.title)),o.a.createElement("p",{className:"reading-item"},e.bible_text),o.a.createElement("p",{className:"reading-item"},e.question_text),o.a.createElement("p",{className:"reading-item prayer-text"},e.prayer_text)):null},n.forwardClick=function(e){var t=n.state.readingList.findIndex(function(e){return e.id===n.state.currentItem.id});n.setState({currentItem:n.state.readingList[t-1]||n.state.currentItem})},n.backwardClick=function(e){var t=n.state.readingList.findIndex(function(e){return e.id===n.state.currentItem.id});n.setState({currentItem:n.state.readingList[t+1]||n.state.currentItem})},n.state={viewCompleted:!1,activeItem:{title:"",description:"",completed:!1,reading_date:""},readingList:[],displayed_form:"",logged_in:!!localStorage.getItem("token"),username:""},n.baseUrl=window.location.protocol+"//"+window.location.host,n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.state.logged_in&&fetch("".concat(this.baseUrl,"/current_user/"),{headers:{Authorization:"JWT ".concat(localStorage.getItem("token"))}}).then(function(e){return e.json()}).then(function(t){e.setState({username:t.username}),e.refreshList(),e.getNewsItem()})}},{key:"getCookie",value:function(e){if(!document.cookie)return null;var t=document.cookie.split(";").map(function(e){return e.trim()}).filter(function(t){return t.startsWith(e+"=")});return 0===t.length?null:decodeURIComponent(t[0].split("=")[1])}},{key:"renderLoginError",value:function(){return o.a.createElement("div",{className:"login-failed"},"Incorrect username or password")}},{key:"sortDyDate",value:function(e){return e.forEach(function(e){e.reading_date=new Date(e.reading_date)}),e.sort(function(e,t){return new Date(e.reading_date)-new Date(t.reading_date)})}},{key:"getClosestReadingToToday",value:function(e){var t=new Date;return e.sort(function(e,n){return Math.abs(t-new Date(e.reading_date))-Math.abs(t-new Date(n.reading_date))}),e[0]}},{key:"getClosestNewsItemToToday",value:function(e){var t=new Date;return e.sort(function(e,n){return Math.abs(t-new Date(e.news_date))-Math.abs(t-new Date(n.news_date))}),e[0].news_item_text}},{key:"handleSidebarItemClick",value:function(e){this.setState({currentItem:e})}},{key:"renderSidebar",value:function(){var e=this,t=this.state.readingList;return t?t.map(function(t){return o.a.createElement("li",{key:t.id,className:"sidebar-item",value:t.id,onClick:function(){e.handleSidebarItemClick(t)}},o.a.createElement("span",{className:"siderbar-title"},t.title,o.a.createElement("p",null,e.formatDate(t.reading_date))))}):null}},{key:"renderApp",value:function(){return this.state.currentItem?o.a.createElement("main",{className:"content"},o.a.createElement("div",{className:"arrow-container"},o.a.createElement("div",{className:"back-button",onClick:this.backwardClick},o.a.createElement("img",{className:"arrow-left",src:S.a,alt:"back"})),o.a.createElement("div",{className:"text-black my-4 page-title"},this.formatDate(this.state.currentItem.reading_date)),o.a.createElement("div",{className:"forward-button",onClick:this.forwardClick},o.a.createElement("img",{className:"arrow-right",src:p.a,alt:"forward"}))),o.a.createElement("div",{className:"sidebar-list-container"},o.a.createElement("ul",{className:"sidebar-list"},this.renderSidebar())),o.a.createElement("ul",{className:"list-group list-group-flush"},this.renderItems()),o.a.createElement("div",{className:"news-bar"},this.getTodaysNewsItem())):null}},{key:"handleLogoClick",value:function(){window.location.assign("https://www.lymingtonrushmore.org/")}},{key:"render",value:function(){var e=this.state.logged_in?null:o.a.createElement(v,{handle_login:this.handle_login}),t=this.state.loginError?this.renderLoginError():null;return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"page-header"},o.a.createElement("img",{className:"logo",src:f.a,alt:"lym-logo",onClick:this.handleLogoClick})),o.a.createElement(C,{logged_in:this.state.logged_in,display_form:this.display_form,handle_logout:this.handle_logout}),e,t,this.state.logged_in?this.renderApp():null)}},{key:"formatDate",value:function(e){return e?new Date(e).toLocaleDateString("en-UK",{weekday:"long",month:window.innerWidth>600?"long":"short",day:"numeric"}):null}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));A.a.render(o.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,2,1]]]);
//# sourceMappingURL=main.88e32a36.chunk.js.map